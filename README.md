## 毕业项目设计

### 项目介绍

现在的项目是一个媒体系统的BFF层，有若干上游系统。
整个公司的系统现在是建立在AWS上，已经分离出来了若干SOA层面，每个系统之间通过内部web service相互访问。


我们项目提供了上游数据的缓存服务以及面向客户端的API服务，需要将上游数据聚合/转换成客户端需要的JSON格式。

公司所有的内容都是公共许可的，所以不需要用户认证，都可以公开访问。内部维护是通过另一套系统经过VPN访问的，不在我们相关的系统范围内。

### 微服务改造

系统本身已经是面向服务的架构，BFF层不适合做太多拆分，所以改造幅度不是很大。
* 将上游系统到BFF层的通信改为grpc，减少通信延时。
* 使用客户端负载均衡访问上游服务。
* 使用kafka替换现在的通知系统，增加系统容量。
* 上游内容聚合使用更好的并发结构。

![System](https://viewer.diagrams.net/?highlight=0000ff&edit=_blank&layers=1&nav=1&title=System#R%3Cmxfile%3E%3Cdiagram%20id%3D%22Ht1M8jgEwFfnCIfOTk4-%22%20name%3D%22Current%22%3E7V1bc%2Bo4Ev41qZp9CGVbvj4CCTNTm8zJTuZMqvaFEliANsZibBOS%2FPqVbMvYkjAmsSEXklMnuC1LsvTp61arJS7AcPn8awRXi1vio%2BDC0PznC3B1YRi67tr0D5O8ZBLb9TLBPMJ%2BnmgruMevKBdquXSNfRRXEiaEBAleVYVTEoZomlRkMIrIpppsRoJqqSs4R5LgfgoDWfqA%2FWTB38v2tjd%2BQ3i%2ByIt2DSe7sYQ8cf4m8QL6ZFMSgesLMIwISbJPy%2BchCljj8XbJnhvtuFtULEJh0uSBHz%2Fgo%2Ffn3Y8oeHydLxZ%2BeDt6vdSNLJsnGKzzN%2B4%2F3FPBMCBrP6948sJbY0VwmKQtag3oP1rgULuw6J0hu%2BoZliAQr52qQJevWB5VgXjtVAW6mL0ulK%2BLFSwJpKtK9ppQvlaqIP0HBmSdBDhEwwJ7GhXOI%2Bhj2idDEpCIykIS0tYbLJJlQK90%2BnGzwAm6X8Epa9UNHTdUNiNhkqOf9kl%2BnTc8y5WiZ8U%2BL5%2FnbKD14CY2e%2FOIrFdpkb9T%2FCvvjunH8ZR15hgGCcsoicgj4pW7MAD9HTHEDGY4CIRKP6EowXQw9AM8Z%2FknhBUH86sAzdIc6ZvgcH6TXl0BLa%2B9qggfxgvk568kAzjHNCsVPZdEOaB%2FRWSJkuiFJsnvAs3MHsnZhY%2B1zXaoOiBnoEVplFpmnhDm9DAvst6OIPohH0SHDCggDai%2FULTE4To%2Bj6bPP5pIOF5FaIljpBpKVt8eUoXX5VAqimh9KPEhkQ8ly5GGEnA1eSgBr4Wh9PP69e5nv%2F%2Fj92h0iWN3bg2df6hucqQhg3yqnfNLEiULMichDK630gHtptAvGmab5oawBk8R8z%2BUJC85POA6IVU8xQmMkj4zHVgZKxRy2Qiz%2BqfZotAXUlBJ6X6GDG4wGCqsuBr7reu7mKyjKaprIG4k0drNUVLDSrmWZ61Xi4UIBTDBT1XbR9Wx6aO0CeBLKUHOZ9uc75hgCzHdrkJMB4LFsie9YOHQD1kN1E8Do%2Fq0qQtAzVotf0rAatEm74Cv5kmq4AFNYspWEqwPoT6REExrYJsSwnjiEhEx0Dme7knswanpBk5QcEdoDXHKfxOSJGS5l7umtI4oqg6ifQQM41X2ojP8zOqhZmRa%2BTV9LcjqM6bTgMes4BRnKLp%2BQpn6ZAUGrO4DOH2cpwRQeudZ%2BtMOSRpWzwNVTHqexJOW3eN2ScXoqBlP7yNKjuwS0i4MOzX3fPxEP87Zx1sywbQDDK2%2FWvHbtLxSCsVDXDSJRIn46BnSB0M6JAme0VpklftQuNY1s%2Be6ErRtp%2BcpkG11hmzZnL6By4kPm%2BFt1zxExCG9N3Lca80s3bvCEc0og03I7AgZe1eaNdQdlXYvOudzoDJCmbGRGb4DeqkygYOs5RuBMrdk%2F0qNLtAOSk2KPsOqwNSR2dfUe5YM0a20A5DaEkj7S%2FhKG9DQ7kHrSLW1PgDOYUg1HIdV87sgNQZHo05bmDcBhQ%2FCVMyb2vBA7Jg2yZzJ4Sjq8tTL9wCT6YKmvyHzWKXu24RvrsMPQO4ImKYrz6DyjD4HaFP%2F2yZt5mPBEthOFZbAOBos66ag9SZq%2FxEuIabJfhle%2FfGv91iaB%2FCpZ1pXI%2BMwVFp9oA2sb8OnKYBnEQmTdtBp6G51FqXJ3ibTUKDT6AidspY%2Be5pUvoxP4mmyhGUB8xDHkaEJjiMgcGLWXJLjSMrI9ATTwLFFI7Q9H5SyN0x59kSgTyWUWWA4pZRynkYdnUwp8mNavXFAu2I8STuCzpS6UfuGJk%2BQgCsTK5e1TqyWQu0fzLSljirx4SQg00cmCibpNe91kVmLdAVx6iqsFV6nKq83Is06KtxLmWZDyix1oc4p6jAalalOZCjR%2FGtKdQAIGdmdOduVbeh8X5iZDWHGncSnwFmx9lLgzBU1YWOlahtCVt5RkabwtQ9Go7MePYEencZt%2BRVtQWnaktI0FQs6XNZ%2BEIlstx2dznIHS4dsVu%2Fx%2F9h85gp8Jq4tN2Uza19GXbOZbJ%2F9Z43WDVeoD%2BEz7sY7gM8GQx1Y38hp%2FU9LfGZ5prROYvf4wCqTmpUGeUm8thW3T23yWskf5VXQM%2B6Oj7uwJdw5QryOK6%2BEHHXuqXc4K%2BDqseGkoOzW%2B3CK1DqdIrWFeaMhRhM2VaTOvoy6VqTu98BaLYL2Q80%2BHdQcoyWbzd2XUddQk%2BMKb9cxnlLRPYqe8LQD6%2B08G927REbzhrSNo5aUqacViwU8JMvUT6tPDdn10V%2F7mFDRXURoWyzPEPxSEBS8w86J7bniDUpzB7SJz6D7SqBzbSE0wFShThXiBySfcnvIk0Oq%2FsY%2BImfofSXoeTy8ZAs9jqiTUV6HnuCPP62wm04rvNNNK1xhaUtc%2BGw6q%2FD25LNjUnFoZIxnVNc69DzyShka09aMxegwCuDroNj4zgsah%2BLY9apc7Zq11apP3hHqZVe3IuT158qHCYobxroybKTaujoeJI0sKu4l9v0saBHF%2BBVOCn1c3YN%2BpUR6%2FZgW1WtxFkdeykX5uAuV2qVK1qqSEo9peCeoL4UwwEvd6gnBAmQ2i1EnXhpDdj6fY%2B9ObjJ2GXvnOFWOAdap58sd%2BqQ%2FThhBbXDAfqXrnJVuY6XreHqlnNoN%2Ba0Rqezu%2Fi4o5uD80KajwztIdNgcvq6yJ6OWUExfvFoQOIY1CGTn%2BRnGOxy8J4ExEEBhvBXG%2BzJqawbkCjv8ciO6WxTLLvgzij%2BQN%2BrTmRSiP4pvYOkWxcYZxXu5GJxR3BzFdtUwBs4xuFj2qmYTfioboXRP%2F4f1HhUj8N3eo0utZ9lm9fAavvXqnTDU3R4QT3uSImO78yABedGxNZb6Ql7zE9qMn46nRJuRH13TLU%2Bd1zDP%2BrZbfesdw2iUl3P%2BRD6Wj%2FVVuvG7dqIrfOKAe7vhdIFkz79x7YCBq1hJyMfUTswfsLHO1cWNKEARRGY4ynCeVk7sUnflB3CMn2q7cGPPODhhrLblbE8fLEwvCQ%2FNWQkUu584DD2n55V%2FOqEpSxPp0KqvaH36jnhN5V%2BXlqnvF3QQMNigaNn48NCMeT7bynbBDi2sbGsOp5aXSkbvVdhaz9PKP8L6OS35aAvd5vd1Caq4tP6IyJNYd06VVd68QGPty6gt2vTU5eys145TTDqlTR4rWk%2BbNyScv5E1tRnFbdNnfLIJmR33%2BdjW3GVVvoFt6XSjOi9oyRHEfEzCiWLO0ehV4eWDCfTJXOpUKVBmhSJMy2c9eUWLwqsY3W1FtR1ffFuRNHkRApJMw3EGg4tG51qKkT7SIcF4mX4dE%2F97hZf0LUcBntD%2F8WTJGhCG9NaSYYpekBAnJKJZjFkz42nci59aiuYxtKrFaMqR4DxEtzxrEcN2W5uzmN9kM3PtINi%2F9nZCL4ouqCHdfaOeFU%2FlkjJqSc8WAWrFuTf1enZP%2BnfrWaLD%2F05u%2F%2F282TxNxj%2Bcy%2Bt79Pdlh9blUWEvIPKNm%2FqNw07HOY59Ke6H5os7h5%2BXKay2iBm1hHvJ3WkZ3eNY5QRXmIvzDxcJ3tgwq0J692CuW8pzDX4W1ztBCQzR81h812GrNpvyNeWpwf16yTYL0v5l%2B%2FT32W2l%2FpR7RephbjSJ1pXKiIKv6wixF6ZmVPBCgUHhNqK1Gvf59fiBRI%2FMMENVY0oBA4nBdvasLo44xSH5tuKENS57jzWl7KGvsrR6qFapg%2Bt%2BL0amfY7jARYPFNXeaEyJJ8xIGb35tA56uf321iz59jtwwfX%2FAQ%3D%3D%3C%2Fdiagram%3E%3Cdiagram%20id%3D%22UU5I8n5a5L1riE0NNXKp%22%20name%3D%22Modified%22%3E7V1Zc6M6Fv41qbrz0C6QWB%2B9xH2nJt3VM%2Bl78%2BiSjWwzAeQBnKV%2F%2FYhFGCTZYAdI4ibp6piDkIT0nUXnHMk3cOq%2FfA3RbvuNONi7AYrzcgNnNwCoqmXQPwnlNaMYlp0RNqHr5IUOhHv3F86JSk7duw6OKgVjQrzY3VWJKxIEeBVXaCgMyXO12Jp41VZ3aIMFwv0KeSL1wXXibUa1dOVA%2FxO7my1rWVXyOz5ihXNCtEUOeS6R4O0NnIaExNkn%2F2WKvWTw2Lg8Pi0nfz1rj3srvlP%2B9fURreOnL1ll83MeKV4hxEF8cdW79eLuxbz7%2BnOzXn%2FX7Ye7rfl3%2FojyhLx9Pl7jh3tKmHpk7%2BSvHb%2BysdwRN4jT%2BdAn9B99eKrc6PTONLkaAZ0j8NdmlaCKV0kdVQJ%2FbVYJKl%2B9yrWv8h0sEYSrSvUK175S6iD9BydkH3tugKcFchVK3ITIcek8TYlHQkoLSEBHb7KNfY9eqfTj89aN8f0OrZJRfaZcR2lrEsQ576iAXecDn9RKsbdLPvsvm4RNR%2Bg50kabkOx3aZP%2FpNwjvbugHxerZDIXyIuTiuKQPGLWuRsA6e88Acxk7Xoe1%2BknHMYuZaWx526S%2BmOSNIfyKw%2Bv0xrpm7jB5i69mkEl772sCQdFW%2Bzkr5QjjzaBXzhWrcG5WjAflVqY%2BDgOX%2BlzeS1Q0bJ6coHF2Pf5wP0mzIXatsT5mpkXRLnE2RRVH7iKfsgZ6wwmUwUm%2B4lD3w320cBhn5%2FDSLDYhdh3IyxjL31sTKkK7ZK9iib6YS9NqbCXbgrsBS1FZC9od8VeQOAi7FATIL8kYbwlGxIg7%2FZAndCZC5xirA5l7kgyBymI%2Fovj%2BDVHDNrHpAqxKEZhPE7sk6SNHQ4Ybe4mvU%2BrxYHDlaCU0v0MLMwqATL4WEryW0xn8mIXTCYdHLIPV%2FjEIOYyk77BBscnyllycITYQ7H7VO2cbKbTR%2BmooNdSgVzqHWr%2BkRAOmFONKuZUyJk6NeWZDjigLOuB%2FGkIqk9rKofcbJDypzjwFmNyOZ6hoC4e8DKiEk3A%2BTnikRcamj4xNAFyrHBJWCUoNG3VFiQME193aIm9H4T20E1l5JLEMfFr5duK9hGHVa6qE9Io2mUvunZfkn7IpTbt%2FJ6%2BFkr6s6CLj8es4RRlOLx9wpmKTRr0kr5P0Opxk0qE0juv058OBSnQRzaswtS2BVmqGyNmz5SlqX6Cxd4kTDUBfDfASC1Hx32iHzfJx29k6dI5Acp4t2O3aWulEpKHGGkZ8hT%2B0QHlZ6M8ILG7pr3IOvfxoa4q2siyBLQb5siWgF3vCOy6APY75C8d1AyCx1Y5PDTpvblp3Spa6d7MDWlFGZKCxPwQ4ThT9KlqyoyCYr4%2BB1BDnFkfmQk9oZcyY9rLRr4RTnOb%2BGdqq8EOgatRQAK9glxTlNGaOtIl68mC2jpuDQG3Yx%2F9omMKlHvYOngNZQyheR54gWmqqvHbgDeC7ytgDW5RBiVOD02yKNO6WpOZRxHKGwGpp%2FEBxastLX9HNpHMTmgT0bnyPwPMc6hplrg8yyv6HDhOfYDP6TC%2FK1KhYVaRCsH7ItVqYvCOH5GPXFrsj%2Bns%2Bz%2FeYreeIXdtTZ%2FNwXlQ1cdQmei%2FjdxNUb0OSRB3CFmgWtVlmiK6vDQggSzoCLK2ALXB4XW2wyu3kz6mw0vnQhjaOf4roHD%2BK8jJzmxsBP%2BVUJFmc1aFafAmbceuMOZ5K6%2FQCHIohYogFKyo7BmWar1LXQr9iHZv4dGpWCzTiaCrsR6NBqCIizBoiRKY0dqP6IkhvQtkcmn6SpJz6ZHVY0Lyluk1wwIvg4tyhYhVZQgsXGBVDdC1eLUaildVkc98aWaLjIzzZK4oF3lxxtuUTeUihFxFRr8BAhUM6DuNPqY36uEHe4NfEUYq4Gfx2rSxYjYAV5XdLwDFENVkPh9U8Tuo4lXUqftTS1M%2Byo57W%2FQsGZL1Oi8S21O9sghVz8Iv9%2Fx8TNmnf0DRZ3Gij4%2BoNxV8el1FXQs%2BMWL07z3eN4zMnyP6mMvxDNE3mapQ%2F4187v%2FrUvTptiZEfowRU3xlz49eiMiK8%2BdAbl8EivGf7%2BX47wDG%2FsEYdAlGk8tnskQd3O%2FyVwzvtKaDmW5tuP4ouyA%2FpRbWe9PCBrdsBXxGZlMtbNZV1LUWlsVsBvjJDJV6%2FBm94c8ELVmBVl1FXePPFvD3bR%2B5K0q6x%2BGTu%2BrAHhyWwrWxQFo3omMcdqmJLSZqTiyHe1XFQIyQjPeOSyjpR0jo8PgDKq8fldyyGBjqO6NSjI98x8%2FRAMWrh6Kp2yPOY6gXiZAVOMpyJqHgEm8PkmLQ5G%2FXwWTA5PVj0rY4TMqyzvoVkGIEZVjCyL1c9UsYu7cljMXF8PgoR9MVjF1Tz5EFzLlpRJamVkVxnrkmzSNqa3UEOgzQ%2FG7QLp0zcfUxmrPBzXbLMaeo3gO2xfiPJFv4r52DYhw1TBNOYJZq7yrqBQ3NK3LfdZwstRNH7i%2B0LPRz9QyB2SnFmh%2B6kj98U5yVUEb6CSY%2FqnGVka4bldlhGwvfiNIvRnUf2ReWGcaqIOt1hDvx%2BgAx6iKZ%2B6mXGHrJDFPjsvHeyGpSY%2BPH7mkbKxS2u7NyMHA%2Fda6krlfF7%2Ft7qDr01l9Fwgb4gNaACarKVdh%2F09xXX1NRS9aAybvAqkc%2B1Je3T6TYt6ZCxMDBwAqXscIRIdgFK8Aqgou9lWezQl1FbbECtxmU7Qc5ygpceTXf4twpK0AxbjGwwkWs0KP74%2FOtERmqGmqFmvIdscIH2ExyHayQDdzACtJ2DM4QqzlDi885O7c8zI8o6pZ1Bjd6e77G%2FkyqT8c8plllHlWvYYbT5TtihsHx3h4zDJrkaIdtbr1gmye7xRfvRzGIjvr%2FYMcVD9yVukC7dkBK%2FImQeQrRaotFrym4NeHEknhhc8bM37b9HWCWym%2BDgOyc5BIvAFOazdHdCVhQ5ozv2Wb%2B4Ftgmx5wAfvLQNfNw6l%2Fhd9NAElzeQeLDTkMm7Y5sss%2FnQhAzeY4omZVWVO%2BIwko26MhRpC2lDMSlODQbxx2ymTUFUc34ZGk%2BCK6qZico0BthT%2BAPVIqP9VjL76oWhXdNhez6S74CYcgTkvitr%2F9FsUXGrw1hqPXVdSWXOV0A6xxXOv8gR7nlj91rFJrnCOL%2BUgSAILNhWJYWVPoN33GIc9BYkJet%2Fg%2BcmZXIb7pyqiaGMe%2BQ%2BCt2SnKiD%2B5q7f0FMaTJZzNUIwcshEmVchv2OHQpe0nMzmjTbm7CP84kE5OfPGlSMK6icsj0YBpTiY3jQ6f5BM0hPN%2BXT%2F91if2d%2Bb69C3nnruk%2F7tLPxlAFNBbfpqLM%2FdJ4MYkpFUskmF2V9EoeuoyCQMoVbtUExPgez00Q%2BswxHAlriHGP%2FXxtt4UuMrpK9W6UIHzJ18JFbWkwCGXe1QXea4p341CZsdyDrxwdIjMpqzQ4xEy%2FJ5ftoPj%2FEMtuS%2Fd4CtqzZjl3Z6gB2zL4mESY3Nz1cnJGYcfVc7USrOAYbQCSwh492hxOl8PJp8Y8Lnf%2B8mONjrDyXb0OruvNKPivAhzzIwu3jqTGWHo1z7EyRtTM8x7pdCggJvTXi3G7HrxQMLHxLDDXRtjKs%2BJksPxDcl37DBa%2B9aYbBfBoIFk0K5VQWZvGkjnT%2F1ULrTG%2BHNYhIo6Pr5C%2BwCxk%2Bvw5YEenXl8FPXSrYd6XUUXo49eHr4MOSt%2B%2BEppePt%2F%3C%2Fdiagram%3E%3C%2Fmxfile%3E)
